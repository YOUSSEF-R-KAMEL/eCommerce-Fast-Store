import{p as S,q as _,r as k,x as U}from"./chunk-UVOI6WJ2.js";import{Hb as s,Ib as g,Jb as I,La as w,Ob as O,Pa as a,S as x,Tb as p,Vb as m,Y as l,ba as y,hb as C,mb as f,nb as h,ob as v,pb as n,qb as o,rb as b}from"./chunk-TQ5CUWMB.js";import"./chunk-CWTPBX7D.js";var c=class extends Error{};c.prototype.name="InvalidTokenError";function j(t){return decodeURIComponent(atob(t).replace(/(.)/g,(i,e)=>{let r=e.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}function B(t){let i=t.replace(/-/g,"+").replace(/_/g,"/");switch(i.length%4){case 0:break;case 2:i+="==";break;case 3:i+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return j(i)}catch{return atob(i)}}function A(t,i){if(typeof t!="string")throw new c("Invalid token specified: must be a string");i||(i={});let e=i.header===!0?0:1,r=t.split(".")[e];if(typeof r!="string")throw new c(`Invalid token specified: missing part #${e+1}`);let d;try{d=B(r)}catch(u){throw new c(`Invalid token specified: invalid base64 for part #${e+1} (${u.message})`)}try{return JSON.parse(d)}catch(u){throw new c(`Invalid token specified: invalid json for part #${e+1} (${u.message})`)}}var E=(()=>{class t{constructor(){this.userId=null,this._httpClient=l(U),this.initializeUserId()}initializeUserId(){try{let e=localStorage.getItem("token");if(e){let r=A(e);this.userId=r?.id||r?.userId||null}}catch{this.userId=null}}getUserOrders(){return this._httpClient.get("orders/user/"+this.userId)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function P(t,i){if(t&1&&(n(0,"div",7)(1,"p"),s(2),o(),b(3,"img",8),n(4,"p",9),s(5),p(6,"currency"),o()()),t&2){let e=i.$implicit;a(2),g(e.product.title),a(),C("src",e.product.imageCover,w)("alt",e.product.title),a(2),g(m(6,4,e.price,"GBP"))}}function $(t,i){if(t&1&&(n(0,"div",3)(1,"div",4)(2,"p",5),s(3),p(4,"currency"),o(),n(5,"p",6),s(6),p(7,"date"),o(),n(8,"h3"),s(9,"Items"),o(),n(10,"div",2),h(11,P,7,7,"div",7,f),o()()()),t&2){let e=i.$implicit;a(3),I("Total order price: ",m(4,2,e.totalOrderPrice,"GBP"),""),a(3),I("Paid At: ",m(7,5,e.paidAt,"dd/MM/yyyy hh:mm:ss a"),""),a(5),v(e.cartItems)}}var L=(()=>{class t{constructor(){this.orders=[],this._allOrdersService=l(E)}ngOnInit(){this.getUserOrders()}getUserOrders(){this._allOrdersService.getUserOrders().subscribe({next:e=>{this.orders=e}})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=y({type:t,selectors:[["app-all-orders"]],standalone:!0,features:[O],decls:6,vars:0,consts:[[1,"m-4"],[1,"text-center","text-main","m-4"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4","mb-3"],[1,"cart","bg-light","px-4","py-2","h-100"],[1,"totalPrice"],[1,"paidAt"],[1,"col","text-center"],["width","120px",1,"rounded-3",3,"src","alt"],[1,"price","mt-2"]],template:function(r,d){r&1&&(n(0,"section",0)(1,"h2",1),s(2,"All Orders"),o(),n(3,"div",2),h(4,$,13,8,"div",3,f),o()()),r&2&&(a(4),v(d.orders))},dependencies:[k,_,S]})}}return t})();export{L as AllOrdersComponent};
